@repo: 'https://raw.githubusercontent.com/kyle1an/SF-1/main';
@repo: 'https://cdn.jsdelivr.net/gh/kyle1an/SF-1@main';
@repo: 'https://cdn.jsdelivr.net/gh/kyle1an/SF-Fonts@master';

@styles: {
  normal: '';
  italic: 'Italic';
}

@thinWeights: {
  Thin: 200;
}

@usualWeights: {
  Light: 300;
  Regular: 400;
  Medium: 500;
  Semibold: 600;
  Bold: 700;
}

@boldWeights: {
  Semibold: 600;
  Bold: 700;
}

@allWeights: {
  Thin: 200;
  Light: 300;
  Regular: 400;
  Medium: 500;
  Semibold: 600;
  Bold: 700
}

@tarSF: {
  nam: 'SF Pro Text';
  dir: '/Fonts/SF-Pro-Text-';
  ext: 'otf';
}

@tarMo: {
  nam: 'SF Mono';
  dir: '/Fonts/SF-Mono-';
  ext: 'otf';
}

@tarCM: {
  nam: 'SF Compact Text';
  dir: '/Fonts/SF-Compact-Text-';
  ext: 'otf';
}

@formats: {
  @ttf: TrueType;
  @otf: OpenType;
}

.load(@textFamilies, @tarSF, @allWeights, @generalUnicode, false);
.load(@boldFamilies, @tarSF, @boldWeights, @generalUnicode, false);
.load(@monoFamilies, @tarMo, @usualWeights, @allUnicode);
.load(@compactFamilies, @tarCM, @allWeights, @generalUnicode);

.load(@families, @tar, @weights, @unicode, @local: true) {
  each(@families, .(@family, @k1, @i1) {
    each(@weights, .(@numeric, @weight-key, @i) {
      each(@styles, .(@style-val, @style, @i2) {
        // @keyword: extract(@weight, 1);
        // @numeric: extract(@weight, 2);

        @font-face {
          font-family: @family;
          .src(@family, @tar, @repo, @weight-key, @style-val, @numeric, @style, @local);
          unicode-range: @unicode;
          font-weight: @numeric;
          font-style: @style;
          font-display: swap;
        }
      })
    })
  })
}

.src(@family, @tar, @repo, @weight-key, @style-val, @numeric, @style, @local) {
  @nam: @tar[nam];
  @dir: @tar[dir];
  @ext: @tar[ext];
  @format: @formats[@@ext];
  @italic: if(@style-val='', e(''), ' Italic');
  src: if(@local, local('@{nam} @{weight-key}@{italic}') e(','),) url("@{repo}@{dir}@{weight-key}@{style-val}.@{ext}") format('@{format}');
}

.load-local(@zhFamilies, @tarCM, @allWeights, @zhUnicode, @styles);

.load-local(@families, @tar, @weights, @unicode, @styles, @local: true) {
  each(@families, .(@family, @k1, @i1) {
    @font-face {
      font-family: @family;
      src: local(@family);
      unicode-range: @unicode;
      font-display: swap;
    }
  })
}

@font-face {
  font-family: 'XcodeDigits';
  src: local('Xcode Digits Regular'), url("https://cdn.jsdelivr.net/gh/kyle1an/SF-Fonts@master/Fonts/XcodeDigits-regular.ttf");
  unicode-range: U+0030-0039;
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}

@generalUnicode: U+0000-024F,
U+02B0-052F,
U+1DC0-20CF,
U+2190-22FF,
U+2460-24FF,
U+25A0-25FF,
U+2700-27FF,
U+2900-2BFF,
U+2C60-2C7F,
U+2DE0-2E7F,
U+3200-32FF,
U+A640-A69F,
U+A700-A7FF,
U+E000-F8FF,
U+FFF0-FFFF,
U+F0000-10FFFF;
@plusUnicode: U+0250-02AF,
U+1D00-1DBF,
U+2190-22FF;
@allUnicode: @generalUnicode, @plusUnicode;

@zhUnicode: U+4E00-9FFF,
U+3400-4DBF,
U+20000-2A6DF,
U+F900-FAFF,
U+2F800-2FA1F;
// U+2A700–2B73F, U+2B740–2B81F, U+2B820–2CEAF,

@zhFamilies: '宋体',
'微軟正黑體',
'微软雅黑',
'Hiragino Sans GB',
'Microsoft JhengHei',
'Microsoft Yahei';

@textFamilies: 'SF Pro Text', 'SF Pro Display',
Akzidenz,
AlibabaPuHuiTi,
'Arial',
arial,
'Arial Unicode MS',
Arimo,
Avenir,
'Benton Sans',
'Crisp Noto Sans Regular',
Content-font,
CustomSansSerif,
'dosis',
font-regular,
Geneva,
gitbook-content-font,
Helvetica,
'Helvetica Neue',
HelveticaNeue,
HelveticaNowDisplay-Regular,
'Helvetica Neue For Number',
'HelveticaNeue-Medium',
'HelveticaNeue-Bold',
Hind,
Inter,
'Lantinghei SC',
lato,
'Lucida Grande',
muli,
mwf-segoeui-web,
Noto,
'Noto Sans',
'Noto Sans SC',
'Noto Sans TC',
'Open Sans',
opensans,
'PingFang SC',
'.PingFang SC',
'PingFangSC',
'PingFang SC Light',
'PingFangSC-Light',
'PingFangSC-Regular',
'PingFangSC-Medium',
'PingFangSC-Semibold',
'pt sans',
Roboto,
Roboto-Light,
Roboto-Regular,
Roboto-Medium,
sans-serif,
'Segoe UI Web (West European)',
'Segoe UI',
SegoeUI,
'-apple-system',
'Source Han Sans CN',
'source sans pro',
system-ui,
Tahoma,
'Times New Roman',
'Trebuchet MS',
'Ubuntu Light',
Ubuntu,
Verdana,
'wf_segoe-ui',
Whitney,
'方正仿宋_gbk',
'宋体',
'微軟正黑體',
'微软雅黑',
'Hiragino Sans GB',
'Microsoft JhengHei',
'Microsoft Yahei';

@boldFamilies: 'Arial Black',
HelveticaNowDisplay-XBd;

@compactFamilies: 'SF Compact Text',
Mulish;

@monoFamilies: 'SF Mono', 'SFMono-Regular',
'Cascadia Mono-SemiLight',
Consolas,
Courier,
'courier new',
'DejaVu Sans Mono',
docs-Consolas,
gitbook-code-font,
Menlo,
Meslo,
Monaco,
Monospace,
monospaced,
'Roboto Mono',
'Source Code Pro',
'source-code-pro',
'SourceCodePro',
'PT Mono',
Ubuntu Mono;
